# Evolution Manager Configuration

# Port for the service (default: 3005)
PORT=3005

# Node environment
NODE_ENV=development

# =============================================================================
# Path Configuration for Portability
# =============================================================================
# These variables allow the same templates to work on different machines.
# Set these to match your local directory structure.

# Base path for all kromosynth repositories
KROMOSYNTH_ROOT=/Users/bjornpjo/Developer/apps/synth.is

# Path to node interpreter (e.g., from nvm)
KROMOSYNTH_NODE=/Users/bjornpjo/.nvm/versions/node/v18.20.3/bin/node

# Path to python interpreter (defaults to ${KROMOSYNTH_ROOT}/kromosynth-evaluate/.venv/bin/python3)
# KROMOSYNTH_PYTHON=/Users/bjornpjo/Developer/apps/synth.is/kromosynth-evaluate/.venv/bin/python3

# Path to vendor directory containing models (e.g., tfjs-model_yamnet)
KROMOSYNTH_VENDOR=/Users/bjornpjo/Developer/vendor

# =============================================================================
# Kromosynth CLI Configuration
# =============================================================================
# Choose one of the following approaches:

# Option 1: Full path to kromosynth.js script (recommended)
KROMOSYNTH_CLI_SCRIPT=/Users/bjornpjo/Developer/apps/synth.is/kromosynth-cli/cli-app/kromosynth.js

# Option 2: Path to kromosynth-cli directory (script assumed at cli-app/kromosynth.js)
# KROMOSYNTH_CLI_PATH=/Users/bjornpjo/Developer/apps/synth.is/kromosynth-cli

# Option 3: Leave unset to use default relative path (../../kromosynth-cli/cli-app/kromosynth.js)

# =============================================================================
# Service Script Paths Configuration
# =============================================================================
# Full paths to service scripts for portability across different deployments.
# If unset, defaults are resolved relative to KROMOSYNTH_ROOT or relative paths.

# Kromosynth CLI gRPC variation service
KROMOSYNTH_CLI_GRPC_VARIATION_SCRIPT=/Users/bjornpjo/Developer/apps/synth.is/kromosynth-cli/gRPC/genomeVariationWS.js

# Kromosynth Render socket server
KROMOSYNTH_RENDER_SCRIPT=/Users/bjornpjo/Developer/apps/synth.is/kromosynth-render/render-socket/socket-server-floating-points.js

# Kromosynth Evaluate scripts
KROMOSYNTH_EVALUATE_FEATURES_SCRIPT=/Users/bjornpjo/Developer/apps/synth.is/kromosynth-evaluate/evaluation/unsupervised/features.py
KROMOSYNTH_EVALUATE_QUALITY_SCRIPT=/Users/bjornpjo/Developer/apps/synth.is/kromosynth-evaluate/evaluation/unsupervised/quality_ref_features.py
KROMOSYNTH_EVALUATE_PROJECTION_SCRIPT=/Users/bjornpjo/Developer/apps/synth.is/kromosynth-evaluate/evaluation/unsupervised/projection_quantised.py

# Working directory for evaluation scripts
KROMOSYNTH_EVALUATE_CWD=/Users/bjornpjo/Developer/apps/synth.is/kromosynth-evaluate/evaluation/unsupervised

# Python interpreter (full path to venv python3; overrides KROMOSYNTH_PYTHON if set)
KROMOSYNTH_EVALUATE_PYTHON_INTERPRETER=/Users/bjornpjo/Developer/apps/synth.is/kromosynth-evaluate/.venv/bin/python3

# YAMNet TensorFlow.js model path (file:// URI)
KROMOSYNTH_YAMNET_MODEL_PATH=file:///Users/bjornpjo/Developer/vendor/tfjs-model_yamnet_tfjs_1/model.json

# Path to evaluation measurement models directory
KROMOSYNTH_MODELS_PATH=/Users/bjornpjo/Developer/apps/synth.is/kromosynth-evaluate/measurements/models

# =============================================================================
# Logging & PM2
# =============================================================================
LOG_LEVEL=info

# PM2 Configuration (optional overrides)
# PM2_LOG_DATE_FORMAT=YYYY-MM-DD HH:mm:ss Z
# PM2_HOME=/path/to/custom/pm2/home

# =============================================================================
# Global User Preferences Configuration
# =============================================================================
# These settings apply to ALL evolution runs managed by this service,
# regardless of which template is used. Request-specific options override these.
# See USER_PREFERENCES_CONFIGURATION.md for full documentation.

# Parent Selection from User-Liked Sounds
# GLOBAL_USER_PREFERENCES_RATE=0.15                    # Probability (0-1) of selecting from user preferences
# GLOBAL_USER_PREFERENCES_SERVICE_URL=http://localhost:3060  # kromosynth-recommend URL
# GLOBAL_USER_PREFERENCES_STRATEGY=weighted           # "weighted" or "uniform"
# GLOBAL_USER_PREFERENCES_USER_LIMIT=20               # Max users to fetch preferences from
# GLOBAL_USER_PREFERENCES_CACHE_SIZE=500              # Max genomes to cache
# GLOBAL_USER_PREFERENCES_CACHE_REFRESH=300           # Cache refresh interval (seconds)

# =============================================================================
# Data Sync Configuration
# =============================================================================
# Sync evorun data (SQLite databases + analysis files) to a central server.
# Uses sqlite3_rsync (SQLite 3.50.0+) for efficient database sync over SSH,
# and REST API with API key auth for analysis files.

# Enable sync (default: false)
# SYNC_ENABLED=true

# Sync interval in milliseconds (default: 300000 = 5 minutes)
# SYNC_INTERVAL_MS=300000

# SSH target for sqlite3_rsync database sync (e.g., user@central-host)
# SYNC_CENTRAL_HOST=user@central-host

# Remote path where database replicas are stored
# SYNC_CENTRAL_PATH=/data/evorun-sync

# URL of the central kromosynth-evoruns service for REST-based file sync
# SYNC_EVORUNS_SERVICE_URL=http://central-host:4004

# API key for authenticating with the central evoruns service (evolution-manager side)
# SYNC_API_KEY=your-secret-key-here

# Accepted API keys on the kromosynth-evoruns service (comma-separated list)
# Configure this in kromosynth-evoruns .env, not here, but documented for reference:
# SYNC_API_KEYS=your-secret-key-here,another-key-for-another-worker

# Path to sqlite3_rsync binary (default: sqlite3_rsync, found via PATH)
# SQLITE3_RSYNC_PATH=sqlite3_rsync

# Sync on pause/stop events (default: true)
# SYNC_ON_PAUSE=true
# SYNC_ON_STOP=true

# Enable/disable specific sync types (default: true)
# SYNC_DATABASES=true
# SYNC_ANALYSIS=true

# Retry configuration
# SYNC_RETRY_MAX_ATTEMPTS=5
# SYNC_RETRY_BASE_DELAY_MS=2000
# SYNC_RETRY_MAX_DELAY_MS=60000

# Evaluation Score Augmentation
# GLOBAL_USER_PREFERENCE_EVAL_ENABLED=false           # Enable user preference evaluation
# GLOBAL_USER_PREFERENCE_EVAL_WEIGHT=0.2              # Weight in final score (0-1)
# GLOBAL_USER_PREFERENCE_EVAL_MODE=additive           # "additive", "multiplicative", or "filter"
# GLOBAL_USER_PREFERENCE_SIMILARITY_THRESHOLD=0.3    # Min similarity for filter mode
# GLOBAL_USER_PREFERENCE_AGGREGATION=max              # "max", "mean", or "weighted_mean"
